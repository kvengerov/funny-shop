# Angular 21+ FSD & Playwright Excellence Rules

You are an expert in Angular 21+, Tailwind CSS, Feature-Sliced Design (FSD), and Playwright testing.
Your goal is to write maintainable, performant, and strictly typed code following modern standards.

## 1. Architectural Structure (FSD)
Adhere to the layer hierarchy (from bottom to top):
- `shared`: Reusable code without business logic (UI-kit, API clients, utils).
- `entities`: Business entities (User, Product) — data, interfaces, basic services.
- `features`: User actions (AuthByEmail, AddToCart) — contain logic.
- `widgets`: Composition layer (Navbar, ProductCardList).
- `pages`: Full application pages.
- `app`: Routing, global styles, providers.

**Crucial:** A layer can only import from layers strictly BELOW it. Use Public APIs (`index.ts`).

## 2. Technical Stack (Angular 21+ & Zoneless)
- **Zoneless**: Application is Zoneless. Never use `NgZone`. Use `provideExperimentalZonelessChangeDetection()`.
- **Signals**: Mandatory for state. Use `signal`, `computed`, `effect`, `input()`, and `viewChild()`.
- **Modern Syntax**: Strictly use Control Flow (`@if`, `@for`, `@switch`).
- **RxJS**: Use ONLY for async streams (HTTP). Convert to signals via `toSignal()` for UI.
- **DI**: Use `inject(Service)` at the field level.

## 3. Testing Strategy (Playwright)
When writing or reviewing tests (`.spec.ts` or `tests/` folder):
- **Locators**: Use `page.getByRole()`, `page.getByText()`, or `page.getByTestId()`.
- **Stability**: Use Web-First assertions (`expect().toBeVisible()`, `expect().toHaveText()`).
- **Zoneless Testing**: Rely on Playwright's auto-waiting for Signal-based DOM updates.
- **Mocking**: Use `page.route()` for API mocking to maintain E2E isolation.
- **Reference**: Always follow `.agent/skills/angular-playwright/SKILL.md`.

## 4. Styling & UI (Tailwind CSS)
- **Framework**: Tailwind CSS exclusively. No `styles` blocks.
- **Layout**: Dashboard style (fixed sidebar, `bg-slate-50` main area).
- **Surfaces**: `bg-white`, `rounded-xl`, `border-slate-200/60`, `shadow-sm`.
- **Interactive**: `hover:translate-y-[-2px] transition-all duration-300`.

## 5. Component Generation
- **Location**: Strictly follow FSD layers.
- **Internal Structure**: Every slice must have `ui/`, `model/` (interfaces/signals), `api/`, and `index.ts`.
- **Naming**: `kebab-case.component.ts`.
- **Change Detection**: `ChangeDetectionStrategy.OnPush` is default.

## 6. Forms & Validation
- **Technique**: Reactive Forms.
- **UI**: Validation errors on `touched/dirty`. `text-red-500 text-xs`.
- **Submission**: Disable button if `invalid` or `pending`.

## 7. Skill Integration
- For deep architectural reviews, use `.agent/skills/angular-review/SKILL.md`.
- For testing-specific tasks, use `.agent/skills/angular-playwright/SKILL.md`.
